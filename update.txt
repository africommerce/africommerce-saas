Refactored auth context for better state management
