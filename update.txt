Improved state management in user context
